<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MY_STUFF</title>
<style>
:root {
    --bg-dark: linear-gradient(180deg, #1a1a2e, #16213e);
    --bg-light: linear-gradient(180deg, #e0eafc, #cfdef3);
    --text-dark: white;
    --text-light: black;
    --card-dark: rgba(255,255,255,0.05);
    --card-light: rgba(0,0,0,0.05);
}
body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: var(--bg-dark);
    color: var(--text-dark);
    transition: background 1.2s ease, color 1.2s ease;
}
@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}
#themeTransition {
    position: fixed; inset: 0;
    background: black;
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
    transition: opacity 0.8s ease;
}
.fade { opacity: 1 !important; }
.title-bar {
    display: flex; align-items: center; justify-content: space-between;
    padding: 15px 25px; position: fixed; top: 0; left: 0;
    width: 100%;
    background-size: 300% 300%;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    z-index: 1000;
    animation: gradientShift 20s ease infinite;
    transition: background 60s linear; /* smooth morphing */
}
.title-bar .logo {
    font-size: 1.8rem; cursor: pointer;
    transition: transform 0.3s ease;
}
.title-bar .logo:hover { transform: scale(1.2) rotate(10deg); }
.title-bar h1 {
    margin: 0; text-transform: uppercase;
    letter-spacing: 3px; font-weight: bold;
    transition: text-shadow 0.4s ease;
    cursor: pointer;
}
.title-bar h1:hover { text-shadow: 0 0 10px #fff, 0 0 20px #ff9800, 0 0 30px #ff5722; }
.mode-toggle {
    cursor: pointer; font-size: 1.2rem; border: none;
    background: rgba(255,255,255,0.2);
    padding: 6px 12px; border-radius: 6px;
    backdrop-filter: blur(5px);
    transition: background 0.3s ease, transform 0.3s ease;
}
.mode-toggle:hover {
    transform: scale(1.1);
    background: rgba(255,255,255,0.3);
}
main { padding-top: 90px; }
section {
    padding: 40px; max-width: 800px; margin: auto;
    background: var(--card-dark);
    border-radius: 10px;
    backdrop-filter: blur(5px);
    margin-top: 20px;
    transition: background 0.6s ease;
}
.menu {
    position: fixed; top: 60px; left: 20px;
    background: rgba(0,0,0,0.6);
    padding: 10px 20px;
    border-radius: 8px;
    backdrop-filter: blur(6px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    transform: scaleY(0);
    transform-origin: top;
    transition: transform 0.3s ease;
}
.menu a {
    display: block; padding: 8px 0;
    color: white; text-decoration: none;
    transition: color 0.2s ease;
}
.menu a:hover { color: #ff9800; }
.menu.show { transform: scaleY(1); }
body.light {
    background: var(--bg-light);
    color: var(--text-light);
}
body.light .menu { background: rgba(255,255,255,0.8); }
body.light .menu a { color: black; }
body.light section { background: var(--card-light); }
</style>
</head>
<body>

<div id="themeTransition"></div>

<header class="title-bar">
    <div class="logo" id="menuToggle">📦</div>
    <h1>MY_STUFF</h1>
    <button class="mode-toggle" id="modeToggle">🌙</button>
</header>

<nav class="menu" id="dropdownMenu">
    <a href="#">Home</a>
    <a href="#">Projects</a>
    <a href="#">Music</a>
    <a href="#">Contact</a>
</nav>

<main>
    <section>
        <h2>Welcome</h2>
        <p>The sky above reflects **both the real-time weather** in your location and **smooth time-of-day transitions**.</p>
    </section>
    <section>
        <h2>Live Smart Sky</h2>
        <p>Allow location access to watch your header transform according to actual morning, evening, clouds, rain, or snow.</p>
        <div style="height: 1000px;"></div>
    </section>
</main>

<script>
const API_KEY = "30cbe4bc30msh5fdcf92c4fd37b1p1c022fjsncc0f1842bb0a"; // Get from OpenWeatherMap
const body = document.body;
const menuToggle = document.getElementById('menuToggle');
const dropdownMenu = document.getElementById('dropdownMenu');
const modeToggle = document.getElementById('modeToggle');
const header = document.querySelector('.title-bar');
const themeOverlay = document.getElementById('themeTransition');

let currentWeather = null;

// Menu
menuToggle.addEventListener('click', () => dropdownMenu.classList.toggle('show'));
document.addEventListener('click', e => {
    if (!menuToggle.contains(e.target) && !dropdownMenu.contains(e.target)) {
        dropdownMenu.classList.remove('show');
    }
});

// Fade transition
function fadeThemeChange(callback) {
    themeOverlay.classList.add('fade');
    setTimeout(() => {
        callback();
        setTimeout(() => themeOverlay.classList.remove('fade'), 300);
    }, 300);
}

// Weather-color mapping
function getWeatherGradient(weather, hour) {
    const isDay = hour >= 6 && hour < 18;
    if (weather.includes("clear"))
        return isDay ? "linear-gradient(-45deg, skyblue, lightyellow)" 
                     : "linear-gradient(-45deg, navy, midnightblue)";
    if (weather.includes("cloud"))
        return isDay ? "linear-gradient(-45deg, lightgray, skyblue)"
                     : "linear-gradient(-45deg, #403d39, #252422)";
    if (weather.includes("rain") || weather.includes("drizzle"))
        return "linear-gradient(-45deg, #3f4c6b, #606c88)";
    if (weather.includes("thunderstorm"))
        return "linear-gradient(-45deg, #2c3e50, #4b79a1)";
    if (weather.includes("snow"))
        return "linear-gradient(-45deg, #e0eafc, #cfdef3)";
    return isDay ? "linear-gradient(-45deg, #87CEEB, #fff)"
                 : "linear-gradient(-45deg, #2c3e50, #000)";
}

// Time-only gradients (base sky if no weather)
function getTimeGradient(hour) {
    if (hour >= 5 && hour < 11) return "linear-gradient(-45deg, rgba(255, 183, 94, 0.8), rgba(255, 224, 178, 0.8))";
    if (hour >= 11 && hour < 17) return "linear-gradient(-45deg, rgba(135, 206, 250, 0.8), rgba(255, 255, 255, 0.8))";
    if (hour >= 17 && hour < 20) return "linear-gradient(-45deg, rgba(255, 94, 98, 0.8), rgba(255, 183, 77, 0.8))";
    return "linear-gradient(-45deg, rgba(25, 25, 112, 0.8), rgba(70, 130, 180, 0.8))";
}

// Apply gradient
function applyGradient(gradient) {
    header.style.background = gradient;
    header.style.backgroundSize = '300% 300%';
}

// Fetch Weather
function fetchWeather() {
    if (!navigator.geolocation) return;
    navigator.geolocation.getCurrentPosition(pos => {
        const { latitude, longitude } = pos.coords;
        fetch(`https://open-weather13.p.rapidapi.com?lat=${latitude}&lon=${longitude}&appid=${API_KEY}`)
            .then(res => res.json())
            .then(data => {
                currentWeather = data.weather[0].description.toLowerCase();
                updateSky();
            })
            .catch(err => console.error("Weather fetch error:", err));
    });
}

// Update sky blending weather + time
function updateSky() {
    const hour = new Date().getHours();
    let gradient;
    if (currentWeather) {
        gradient = getWeatherGradient(currentWeather, hour);
    } else {
        gradient = getTimeGradient(hour);
    }
    applyGradient(gradient);
}

// Auto theme setting for dark/light body
function setThemeByTime() {
    const hour = new Date().getHours();
    const isLight = hour >= 6 && hour < 18;
    body.classList.toggle('light', isLight);
    modeToggle.textContent = isLight ? '☀️' : '🌙';
}

// Manual override
modeToggle.addEventListener('click', () => {
    fadeThemeChange(() => {
        body.classList.toggle('light');
        modeToggle.textContent = body.classList.contains('light') ? '☀️' : '🌙';
    });
});

// Init
setThemeByTime();
fetchWeather();
updateSky();

// Update time-sky every minute
setInterval(() => {
    setThemeByTime();
    updateSky();
}, 60 * 1000);

// Refresh weather every 10 minutes
setInterval(fetchWeather, 10 * 60 * 1000);
</script>

</body>
</html>
